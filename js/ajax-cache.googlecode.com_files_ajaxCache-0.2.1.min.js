/*!
 * ajax-cache JavaScript Library v0.2.1
 * http://code.google.com/p/ajax-cache/
 *
 * Includes few JSON methods (open source)
 * http://www.json.org/js.html
 *
 * Date: 2010-08-03
 */
function ajaxCache(type,on,lifetime){if(on){this.on=true;}else
this.on=false;if(lifetime!=null){this.defaultLifetime=lifetime;}
this.type=type;switch(this.type){case'URL':this.put=this.put_url;break;case'GET':this.put=this.put_GET;break;}};ajaxCache.prototype.on=false;ajaxCache.prototype.type;ajaxCache.prototype.defaultLifetime=1800000;ajaxCache.prototype.items=Object();ajaxCache.prototype.put_url=function(url,response,lifetime){if(lifetime==null)lifetime=this.defaultLifetime;var key=this.make_key(url);this.items[key]=Object();this.items[key].key=key;this.items[key].url=url;this.items[key].response=response;this.items[key].expire=(new Date().getTime())+lifetime;return true;}
ajaxCache.prototype.put_GET=function(url,data,response,lifetime){if(lifetime==null)
lifetime=this.defaultLifetime;var key=this.make_key(url,[data]);this.items[key]=Object();this.items[key].key=key;this.items[key].url=url;this.items[key].data=data;this.items[key].response=response;this.items[key].expire=(new Date().getTime())+lifetime;return true;}
ajaxCache.prototype.get=function(url,params){var key=this.make_key(url,params);if(this.items[key]==null)
return false;if(this.items[key].expire<(new Date().getTime()))
return false;return this.items[key].response;}
ajaxCache.prototype.make_key=function(url,params){var key=url;switch(this.type){case'URL':break;case'GET':key+=this.stringify(params[0]);break;}
return key;}
ajaxCache.prototype.flush=function(){cache.items=Object();return true;}
ajaxCache.prototype.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}
rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}
return this.str('',{'':value});}
ajaxCache.prototype.quote=function(string){var escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}
ajaxCache.prototype.str=function(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}
if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return this.quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=this.str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap
+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==='string'){v=this.str(k,value);if(v){partial.push(this.quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=this.str(k,value);if(v){partial.push(this.quote(k)+(gap?': ':':')+v);}}}}
v=partial.length===0?'{}':gap?'{\n'+gap
+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}